<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>ZÂ Radio â€“Â LiveÂ Stream</title>

  <!-- ð—¦ð˜ð˜†ð—¹ð—² minimalÂ -->
  <style>
    :root{
      --bg:#111;
      --fg:#f5f5f5;
      --accent:#1db954;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      background:var(--bg);
      color:var(--fg);
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
      text-align:center;
    }
    h1{margin:0 0 .25em;font-size:2.4rem;color:var(--accent)}
    small{color:#aaa}
    audio{width:90%;max-width:420px;margin:1.2em 0}
    #nowPlaying{margin-top:.8em;font-size:1.1rem}
    a{color:var(--accent)}
  </style>
</head>
<body>

  <h1>ðŸŽµÂ ZÂ Radio</h1>
  <small>Musique&nbsp;24&nbsp;/&nbsp;7 â€“Â IcecastÂ Stream</small>

  <!-- ð—Ÿð—²ð—°ð˜ð—²ð˜‚ð—¿ -->
  <audio id="player" controls preload="none">
    <source src="http://zradio.ddns.net:8000/stream" type="audio/mpeg">
    Votre navigateur ne supporte pas lâ€™audioÂ HTML5.
  </audio>

  <!-- ð— ð—²ð˜ð—®ð—±ð—¼ð—»ð—»ð—²Ìð—²ð˜€ dynamiques -->
  <div id="nowPlaying">Chargementâ€¦</div>

  <script>
  /* --- RÃ©cupÃ©ration JSON Icecast toutes les 15Â s --- */
  const statusURL = "http://zradio.ddns.net:8000/status-json.xsl";
  const nowPlaying = document.getElementById("nowPlaying");

  async function refresh() {
    try {
      const r = await fetch(statusURL);
      if (!r.ok) throw new Error(r.status);
      const data = await r.json();

      /* source est un objet ou un tableau selon le nombre de mountpoints */
      let src = data.icestats.source;
      if (Array.isArray(src)) {
        src = src.find(s => s.listenurl.endsWith("/stream")) || src[0];
      }

      const title = src.title || "Titre inconnu";
      const listeners = src.listeners ?? 0;
      nowPlaying.textContent = `ðŸŽ¶Â ${title}Â Â Â ðŸ‘¥Â AuditeursÂ :Â ${listeners}`;
    } catch (e) {
      nowPlaying.textContent = "Flux indisponibleâ€¦";
    }
  }
  refresh();
  setInterval(refresh, 15000);
  </script>

  <!-- ð—–ð—¿ð—²Ìð—±ð—¶ð˜ simple -->
  <footer style="margin-top:2.5rem;font-size:.8rem;color:#666">
    Â©Â 2025Â <span style="color:var(--accent)">ZÂ Radio</span> â€“Â Powered by <a href="https://icecast.org" target="_blank">IcecastÂ 2</a>
  </footer>

</body>
</html>
